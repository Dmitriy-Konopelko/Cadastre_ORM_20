<!DOCTYPE html>
<!-- saved from url=(0105)http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/ -->
<html lang="ru-RU"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2.0, user-scalable=yes">
<title>Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа | Записная книжка программиста-новичка, C#, SQL, PHP и все-все-все</title>

<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="http://nullpro.info/xmlrpc.php">
<!--[if lt IE 9]>
<script src="http://nullpro.info/wp-content/themes/weaver-ii/js/html5.js" type="text/javascript"></script>
<![endif]-->

<script type="text/javascript" async="" src="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/ga.js.Без названия"></script><script type="text/javascript">var weaverIsMobile=false;var weaverIsSimMobile=false;var weaverIsStacked=false;var weaverThemeWidth=940;var weaverMenuThreshold=640;var weaverHideMenuBar=false;var weaverMobileDisabled=false;var weaverFlowToBottom=false;var weaverHideTooltip=false;var weaverUseSuperfish=false;</script>
<link rel="alternate" type="application/rss+xml" title="Записная книжка программиста-новичка, C#, SQL, PHP и все-все-все » Лента" href="http://nullpro.info/feed/">
<link rel="alternate" type="application/rss+xml" title="Записная книжка программиста-новичка, C#, SQL, PHP и все-все-все » Лента комментариев" href="http://nullpro.info/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Записная книжка программиста-новичка, C#, SQL, PHP и все-все-все » Лента комментариев к «Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа»" href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/nullpro.info\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.2.28"}};
			!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/wp-emoji-release.min.js.Без названия" type="text/javascript"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="weaverii-main-style-sheet-css" href="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/style.min.css" type="text/css" media="all">
<link rel="stylesheet" id="weaverii-mobile-style-sheet-css" href="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/style-mobile.min.css" type="text/css" media="all">
<link rel="stylesheet" id="cfq-css" href="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/style.css" type="text/css" media="all">
<!-- This site uses the Google Analytics by Yoast plugin v5.4.4 - Universal disabled - https://yoast.com/wordpress/plugins/google-analytics/ -->
<script type="text/javascript">

	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-25655790-2']);
	_gaq.push(['_gat._forceSSL']);
	_gaq.push(['_trackPageview']);

	(function () {
		var ga = document.createElement('script');
		ga.type = 'text/javascript';
		ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0];
		s.parentNode.insertBefore(ga, s);
	})();

</script>
<!-- / Google Analytics by Yoast -->
<script type="text/javascript" src="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/jquery.js.Без названия"></script>
<script type="text/javascript" src="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/jquery-migrate.min.js.Без названия"></script>
<script type="text/javascript">
/* <![CDATA[ */
var AJAXCommentPreview = {"loading":"Loading\u2026","error":"Preview error","emptyString":"Click the \"Preview\" button to preview your comment here.","url":"http:\/\/nullpro.info\/wp-admin\/admin-ajax.php?action=ajax_comment_preview"};
/* ]]> */
</script>
<script type="text/javascript" src="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/ajax-comment-preview.js.Без названия"></script>
<script type="text/javascript" src="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/quicktags.php"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://nullpro.info/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://nullpro.info/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Работаем с MS Word из C#, часть 0, класс и тестовый проект-пример WinForms" href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-0-klass-i-testovyj-proekt-primer-winforms/">
<link rel="next" title="Работаем с MS Word из C#, часть 2. Вставляем текст на закладку и форматируем" href="http://nullpro.info/2012/ms-word-iz-vstavlyaem-tekst-i-formatiruem/">
<link rel="canonical" href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/">
<link rel="shortlink" href="http://nullpro.info/?p=786">
<!-- TRUEedit 1.0 by Zachary Segal: http://www.illproductions.com -->
<!-- Weaver II Extras Version 2.3 -->

<!-- This site is using Weaver II 2.1.12 (43) subtheme: Twenty Ten -->
<style type="text/css">
/* Weaver II styles - Version 43 */
a {color:#0066CC;}
a:visited {color:#743399;}
a:hover {color:#FF4B33;}
.entry-title a {color:#000000;}
.entry-title a:visited {color:#000000;}
.entry-meta a, .entry-utility a {color:#888888;}
.entry-meta a:visited, .entry-utility a:visited {color:#888888;}
.entry-meta a:hover, .entry-utility a:hover {color:#FF4B33;}
.widget-area a {color:#0066CC;}
.widget-area a:visited {color:#743399;}
.widget-area a:hover {color:#FF4B33;}
#wrapper {border: 1px solid #222;}
#wrapper, #branding, #colophon, .commentlist li.comment, #respond, #sidebar_primary,#sidebar_right,#sidebar_left,.sidebar_top,.sidebar_bottom,.sidebar_extra,#first,#second,#third,#fourth,.mobile_widget_area {-moz-border-radius: 10px; -webkit-border-radius: 10px; border-radius: 10px;}
#sidebar_wrap_right.right-1-col,#sidebar_wrap_right.right-2-col,#sidebar_wrap_right.right-2-col-bottom,
#sidebar_wrap_left.left-1-col,#sidebar_wrap_left.left-2-col,#sidebar_wrap_left.left-2-col-bottom,#sidebar_wrap_left,#sidebar_wrap_right
{-moz-border-radius: 10px; -webkit-border-radius: 10px; border-radius: 10px;}
.commentlist li.comment .comment-meta {-moz-border-radius-topleft: 7px; -moz-border-radius-topright: 7px;
 -webkit-border-top-left-radius: 7px; -webkit-border-top-right-radius: 7px; border-top-left-radius: 7px; border-top-right-radius: 7px;}
#access {-moz-border-radius-bottomleft: 7px; -moz-border-radius-bottomright: 7px;
 -webkit-border-bottom-left-radius: 7px; -webkit-border-bottom-right-radius: 7px; border-bottom-left-radius: 7px; border-bottom-right-radius: 7px;}
#access2 {-moz-border-radius-topleft: 7px; -moz-border-radius-topright: 7px;
 -webkit-border-top-left-radius: 7px; -webkit-border-top-right-radius: 7px; border-top-left-radius: 7px; border-top-right-radius: 7px;}
body {background-image: url(/wp-content/themes/weaver-ii/images/gr.png); background-attachment: scroll; background-repeat: repeat-x;}
#wrapper {-webkit-box-shadow: 0 0 3px 3px rgba(0,0,0,0.25); -moz-box-shadow: 0 0 3px 3px rgba(0,0,0,0.25); box-shadow: 0 0 3px 3px rgba(127,127,127,0.25);}
#wrapper{max-width:940px;}
#sidebar_primary,.mobile_widget_area {background-color:transparent;}
#sidebar_right {background-color:transparent;}
#sidebar_left {background-color:transparent;}
.sidebar_top,.sidebar_extra {background-color:transparent;}
.sidebar_top,.sidebar_extra {border: 1px solid #222;}
.sidebar_bottom {background-color:transparent;}
.sidebar_bottom {border: 1px solid #222;}
#first,#second,#third,#fourth {background-color:transparent;}
.widget {background-color:transparent;}
#container_wrap.right-1-col{width:75.000%;} #sidebar_wrap_right.right-1-col{width:25.000%;}
#container_wrap.right-2-col,#container_wrap.right-2-col-bottom{width:67.000%;} #sidebar_wrap_right.right-2-col,#sidebar_wrap_right.right-2-col-bottom{width:33.000%;}
#container_wrap.left-1-col{width:75.000%;} #sidebar_wrap_left.left-1-col{width:25.000%;}
#container_wrap.left-2-col,#container_wrap.left-2-col-bottom{width:67.000%;} #sidebar_wrap_left.left-2-col,#sidebar_wrap_left.left-2-col-bottom{width:33.000%;}
#container_wrap{width:66.000%;} #sidebar_wrap_left{width:17.000%;} #sidebar_wrap_right{width:17.000%;}
#sidebar_wrap_2_left_left, #sidebar_wrap_2_right_left {width:54.000%;margin-right:1%;}
#sidebar_wrap_2_left_right, #sidebar_wrap_2_right_right {width:45.000%;}
@media only screen and (max-width:640px) { /* header widget area mobile rules */
} /* end mobile rules */
#main {padding: 20px 0 0 0;}
.menu_bar a, .mobile_menu_bar a {font-weight:bold;}
.menu_bar, .menu_bar a,.menu_bar a:visited,.mobile_menu_bar a {color:#000000;}
.menu_bar li:hover > a, .menu_bar a:focus {background-color:#B8B8B8;}
.menu_bar li:hover > a, .menu_bar a:focus {color:#000000;}
.menu_bar ul ul a {background-color:#454545;}
.menu_bar ul ul a,.menu_bar ul ul a:visited {color:#AAAAAA;}
.menu_bar ul ul :hover > a {background-color:#333333;}
.menu_bar ul ul :hover > a {color:#FFFFFF;}
.menu_bar, .mobile_menu_bar, .menu-add {background-color:#D1D1D1;}
.mobile-menu-link {border-color:#000000;}
.widget-area .menu-vertical,.menu-vertical {clear:both;background-color:transparent;margin:0;width:100%;overflow:hidden;border-bottom:3px solid #000000;border-top:1px solid #000000;}
.widget-area .menu-vertical ul, .menu-vertical ul {margin: 0; padding: 0; list-style-type: none;  list-style-image:none;font-family: inherit;}
.widget-area .menu-vertical li a, .widget-area .menu-vertical a:visited, .menu-vertical li a, .menu-vertical a:visited {
color: #000000;  background-color: #D1D1D1; display: block !important; padding: 5px 10px; text-decoration: none; border-top:2px solid #000000;}
.widget-area .menu-vertical a:hover,.widget-area .menu-vertical a:focus, .menu-vertical a:hover,.menu-vertical a:focus {
color: #000000; background-color: #B8B8B8;text-decoration: none;}
.widget-area .menu-vertical ul ul li, .menu-vertical ul ul li { margin: 0; }
.widget-area .menu-vertical ul ul a,.menu-vertical ul ul a {color: #000000; background-color: #D1D1D1;
 display: block; padding: 4px 5px 4px 25px; text-decoration: none;border:0;
 border-top:1px solid #000000;}
.widget-area .menu-vertical ul ul a:hover,#wrap-header .menu-vertical ul ul a:hover,#wrap-header .menu-vertical ul a:hover {color: #000000; background-color: #B8B8B8; text-decoration: none;}
.widget-area .menu-vertical ul ul ul a,.menu-vertical ul ul ul a {padding: 4px 5px 4px 35px;}
.widget-area .menu-vertical ul ul ul a,.menu-vertical ul ul ul ul a {padding: 4px 5px 4px 45px;}
.widget-area .menu-vertical ul ul ul ul a,.menu-vertical ul ul ul ul ul a {padding: 4px 5px 4px 55px;}
.menu_bar .current_page_item > a, .menu_bar .current-menu-item > a, .menu_bar .current-cat > a, .menu_bar .current_page_ancestor > a,.menu_bar .current-category-ancestor > a, .menu_bar .current-menu-ancestor > a, .menu_bar .current-menu-parent > a, .menu_bar .current-category-parent > a,.menu-vertical .current_page_item > a, .menu-vertical .current-menu-item > a, .menu-vertical .current-cat > a, .menu-vertical .current_page_ancestor > a, .menu-vertical .current-category-ancestor > a, .menu-vertical .current-menu-ancestor > a, .menu-vertical .current-menu-parent > a, .menu-vertical .current-category-parent > a,.widget-area .menu-vertical .current_page_item > a, .widget-area .menu-vertical .current-menu-item > a, .widget-area .menu-vertical .current-cat > a, .widget-area .menu-vertical .current_page_ancestor > a {color:#000000 !important;}
#content, .entry-content h1, .entry-content h2 {color:#444444;}
#content h1, #content h2, #content h3, #content h4, #content h5, #content h6, #content dt, #content th,
h1, h2, h3, h4, h5, h6,#author-info h2 {color:#000000;}
#content h1.entry-title {color:#000000;}
.commentlist li.comment, #respond {background-color:transparent;}
#content table {border: 1px solid #e7e7e7;margin: 0 -1px 24px 0;text-align: left;width: 100%;}
#content tr th, #content thead th {color: #888;font-size: 12px;font-weight: bold;line-height: 18px;padding: 9px 24px;}
#content tr td {border-style:none; border-top: 1px solid #e7e7e7; padding: 6px 24px;}
#content tr.odd td {background: #f2f7fc;}
.wp-caption p.wp-caption-text, #content .gallery .gallery-caption,.entry-attachment .entry-caption {color:#333333;}
#content img.size-full, #content img.size-large, #content img.size-medium, #content img.size-thumbnail, #content .attachment-thumbnail, #content .gallery img,#content .gallery-thumb img,.entry-attachment img, #content .wp-caption img, #content img.wp-post-image,#content img[class*="wp-image-"],#author-avatar img,img.avatar {background-color:transparent;}
.home .sticky, #container.page-with-posts .sticky, #container.index-posts .sticky {background-color:#CFCFCF;}
.entry-meta, .entry-content label, .entry-utility {color:#888888;}
body {font-size:12px;}
body {font-family:Tahoma, Arial,sans-serif;}
h3#comments-title,h3#reply-title,.menu_bar,.mobile_menu_bar,
#author-info,#infobar,#nav-above, #nav-below,#cancel-comment-reply-link,.form-allowed-tags,
#site-info,#site-title,#wp-calendar,#comments-title,.comment-meta,.comment-body tr th,.comment-body thead th,
.entry-content label,.entry-content tr th,.entry-content thead th,.entry-format,.entry-meta,.entry-title,
.entry-utility,#respond label,.navigation,.page-title,.pingback p,.reply,.widget-title,
.wp-caption-text,input[type=submit] {font-family:Tahoma, Arial,sans-serif;}
body {background-color:#DEDEDE;}
body {color:#444444;}
#wrapper {background-color:#FAFAFA;}
#main {background-color:transparent;}
#container {background-color:transparent;}
#content {background-color:transparent;}
#content .post,.post {background-color:transparent;}
#branding {background-color:transparent;}
#branding #branding img {border-top: 4px solid #000;border-bottom: 1px solid #000;clear: both;display: block;}
#colophon {background-color:transparent;}
hr {background-color:#000000;}
.entry-meta {background-color:transparent;}
.entry-utility {background-color:transparent;}
input, textarea, ins, pre {background-color:#F0F0F0;}
.widget {color:#666666;}
.widget-title, .widget_search label, #wp-calendar caption {color: #222222;}
#site-title a {color:#000000;}
#site-description {color:#666666;}
/* Weaver II Mobile Device Options */
.weaver-any-mobile  #main a, .weaver-any-mobile  #mobile-widget-area a, .weaver-any-mobile  .sidebar_top a, .weaver-any-mobile  .sidebar_bottom a, .weaver-any-mobile  .sidebar_extra a {text-decoration: underline !important;}
@media only screen and (max-width:768px) and (orientation:portrait) {body {padding: 0px !important;}}
@media only screen and (max-width:640px) {
#main a, #mobile-widget-area a, .sidebar_top a, .sidebar_bottom a, .sidebar_extra a{text-decoration: underline !important;}
}
@media only screen and (max-width: 580px) {
}
blockquote { 
    font-style: normal;
    border-left: 6px solid grey;
    padding: 0px;
    padding-left: 10px;
    margin-left:  20px;
    margin-right: 20px;

   }
/* end Weaver II CSS */
</style> <!-- end of main options style section -->


<!--[if lte IE 8]>
<style type="text/css" media="screen">
#content img.size-thumbnail,#content img.size-medium,#content img.size-large,#content img.size-full,#content img.attachment-thumbnail,
#content img.wp-post-image,img.avatar,.format-chat img.format-chat-icon,
#wrapper,#branding,#colophon,#content, #content .post,
#sidebar_primary,#sidebar_right,#sidebar_left,.sidebar_top,.sidebar_bottom,.sidebar_extra,
#first,#second,#third,#fourth,
#commentform input:focus,#commentform textarea:focus,#respond input#submit {
		behavior: url(http://nullpro.info/wp-content/themes/weaver-ii/js/PIE/PIE.php) !important; position:relative;
}
</style>
<![endif]-->

<!-- End of Weaver II options -->
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<link rel="stylesheet" type="text/css" href="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/shCore.css"><link rel="stylesheet" type="text/css" href="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/shThemeEclipse.css"><style type="text/css" id="syntaxhighlighteranchor"></style>
<!-- begin SI CAPTCHA Anti-Spam - comment form style --><style type="text/css">div#captchaImgDiv { display:block; }.captchaSizeDivSmall { width:175px; height:45px; padding-top:10px; }.captchaSizeDivLarge { width:250px; height:60px; padding-top:10px; }img#si_image_com,#si_image_reg,#si_image_log,#si_image_side_login { border-style:none; margin:0; padding-right:5px; float:left; }.captchaImgRefresh { border-style:none; margin:0; vertical-align:bottom; }div#captchaInputDiv { display:block; padding-top:15px; padding-bottom:5px; }label#captcha_code_label { margin:0; }input#captcha_code { width:65px; }</style><!-- end SI CAPTCHA Anti-Spam - comment form style --></head>

<body class="single single-post postid-786 single-format-standard single-author singular not-logged-in weaver-desktop weaver-mobile-smart-nostack">
<a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#page-bottom" id="page-top">↓</a> <!-- add custom CSS to use this page-bottom link -->
<div id="wrapper" class="hfeed">
<div id="wrap-header">
	<header id="branding" role="banner"><div id="branding-content">
		<div id="site-logo"></div>
		<div id="site-logo-link" onclick="location.href=&#39;http://nullpro.info/&#39;;"></div>

		<div class="title-description title-description-xhtml">
			<h1 id="site-title"><span><a href="http://nullpro.info/" title="Записная книжка программиста-новичка, C#, SQL, PHP и все-все-все" rel="home">Записная книжка программиста-новичка, C#, SQL, PHP и все-все-все</a></span></h1>
			<h2 id="site-description"> Я ведь это уже делал, но хрен теперь найдешь тот кусок кода, гуглим снова… Где бы найти простое и понятное руководство для начинающего, а не тонкости для мега-гуру?</h2>
		</div>
	</div></header><!-- #branding-content, #branding -->
<div id="wrap-bottom-menu">
<div id="mobile-bottom-nav" class="mobile_menu_bar" style="padding: 5px 10px; clear: both; display: none;">
	<div style="margin-bottom:20px;">
<span class="mobile-home-link">
	<a href="http://nullpro.info/" title="Записная книжка программиста-новичка, C#, SQL, PHP и все-все-все" rel="home">Главная</a></span>
	<span class="mobile-menu-link"><a href="javascript:void(null);" onclick="weaverii_ToggleMenu(document.getElementById(&#39;nav-bottom-menu&#39;), this, &#39;Меню ↓&#39;, &#39;Меню ↑&#39;)">Меню ↓</a></span></div>
</div>
		<div class="skip-link"><a class="assistive-text" href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#content" title="">Перейти к основному содержимому</a></div>
			<div class="skip-link"><a class="assistive-text" href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#sidebar_primary" title="">Перейти к дополнительному содержимому</a></div>
				<div id="nav-bottom-menu" style="display: block;"><nav id="access" class="menu_bar" role="navigation">
<div class="menu"><ul id="menu-nullpro-menu" class="menu"><li id="menu-item-522" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-522"><a href="http://nullpro.info/">Главная</a></li>
<li id="menu-item-523" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-523"><a href="http://nullpro.info/category/c/">C#</a></li>
<li id="menu-item-524" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-524"><a href="http://nullpro.info/category/c/winforms/">WinForms</a></li>
<li id="menu-item-526" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-526"><a href="http://nullpro.info/category/ms-sql-server/">Transact SQL / MS SQL</a></li>
<li id="menu-item-957" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-957"><a href="http://nullpro.info/category/php/">Php</a></li>
<li id="menu-item-808" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-808"><a href="http://nullpro.info/category/teoriya/">Теория</a></li>
<li id="menu-item-525" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-525"><a href="http://nullpro.info/category/vyskazyvaniya/">Разное</a></li>
</ul></div>		</nav></div><!-- #access --></div> <!-- #wrap-bottom-menu -->
</div> <!-- #wrap-header -->
	<div id="infobar">
<span id="breadcrumbs"><span class="crumbs"><a href="http://nullpro.info/">Главная</a>→<a href="http://nullpro.info/category/c/">C#</a>→<a href="http://nullpro.info/category/c/ms-office/">MS Office</a>→<span class="bcur-page">Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа</span></span></span>	<span class="infobar_right">
<span id="infobar_paginate"></span>
	</span></div><div class="weaver-clear"></div><!-- #infobar -->
	<div id="main"><div id="sidebar_wrap_left" class="left-1-col equal_height">
	<div id="sidebar_primary" class="widget-area weaver-clear" role="complementary">
<aside id="search-2" class="widget widget_search"><form role="search" style="background:transparent;" method="get" class="searchform" action="http://nullpro.info/">
	<label class="screen-reader-text" for="s">Найти:</label>
	<input type="search" value="" name="s" id="s" placeholder="Search Site">
	<input class="searchformimg" type="image" src="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/search_button.gif" alt="Search">
	</form></aside><aside id="categories-2" class="widget widget_categories"><h3 class="widget-title">Рубрики</h3>		<ul>
	<li class="cat-item cat-item-3"><a href="http://nullpro.info/category/c/">C#</a>
<ul class="children">
	<li class="cat-item cat-item-36"><a href="http://nullpro.info/category/c/asp/">ASP</a>
</li>
	<li class="cat-item cat-item-31"><a href="http://nullpro.info/category/c/ms-office/">MS Office</a>
	<ul class="children">
	<li class="cat-item cat-item-33"><a href="http://nullpro.info/category/c/ms-office/excel/">Excel</a>
</li>
	</ul>
</li>
	<li class="cat-item cat-item-14"><a href="http://nullpro.info/category/c/winforms/">WinForms</a>
</li>
	<li class="cat-item cat-item-34"><a href="http://nullpro.info/category/c/samouchitel-c/">Самоучитель C#</a>
</li>
</ul>
</li>
	<li class="cat-item cat-item-13"><a href="http://nullpro.info/category/php/">Php</a>
<ul class="children">
	<li class="cat-item cat-item-21"><a href="http://nullpro.info/category/php/wordpress/">Wordpress</a>
</li>
</ul>
</li>
	<li class="cat-item cat-item-23"><a href="http://nullpro.info/category/ms-sql-server/">Transact SQL / MS SQL</a>
</li>
	<li class="cat-item cat-item-30"><a href="http://nullpro.info/category/perevody/">переводы</a>
</li>
	<li class="cat-item cat-item-18"><a href="http://nullpro.info/category/vyskazyvaniya/">Разное</a>
</li>
	<li class="cat-item cat-item-32"><a href="http://nullpro.info/category/teoriya/">Теория</a>
</li>
		</ul>
</aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h3 class="widget-title">Свежие записи</h3>		<ul>
					<li>
				<a href="http://nullpro.info/2015/vyrezaem-chislovuyu-chast-iz-stroki-v-transact-sql/">Вырезаем числовую часть из начала строки в transact-sql</a>
						</li>
					<li>
				<a href="http://nullpro.info/2014/pul-soedinenij-s-bazoj-dannyx-v-ado-net/">Пул соединений с базой данных в ADO.NET / OleDb - как избежать проблем с утечкой соединений в ASP.NET (перевод)</a>
						</li>
					<li>
				<a href="http://nullpro.info/2014/asp-net-mvc-jqury-i-ajax-otsylaem-dannye-na-server/">ASP .Net MVC, JQuery и AJAX - отсылаем данные на сервер</a>
						</li>
					<li>
				<a href="http://nullpro.info/2014/razdelitel-tysyach-i-drobnoj-chasti-dlya-decimal/">Разделитель тысяч и дробной части для decimal</a>
						</li>
					<li>
				<a href="http://nullpro.info/2014/sozdaem-rasshirennyj-control-v-winforms-nasleduyas-ot-sushhestvuyushhego/">Создаем расширенный Control в WinForms наследуясь от существующего</a>
						</li>
					<li>
				<a href="http://nullpro.info/2014/vstavka-strok-i-izmenenie-grnic-yacheek-v-excel-interop-iz-c/">Вставка строк и изменение границ ячеек в Excel Interop из C#</a>
						</li>
					<li>
				<a href="http://nullpro.info/2014/kak-prochitat-dannye-iz-udalennogo-datarow-v-datatable/">Как прочитать данные из удаленного DataRow  в DataTable</a>
						</li>
					<li>
				<a href="http://nullpro.info/2014/kodirovkoj-sql-studio-v-outlook/">Проблемы с кодировкой при копировании русского текста из MS SQL Studio в Outlook/Word/Office</a>
						</li>
					<li>
				<a href="http://nullpro.info/2014/kak-proverit-sushhestvuet-li-tablica-v-ms-sql-server-pered-udaleniemsozdaniem/">Как проверить, существует ли таблица в MS SQL Server перед удалением/созданием</a>
						</li>
					<li>
				<a href="http://nullpro.info/2014/ochen-prosto/">Очень просто...</a>
						</li>
					<li>
				<a href="http://nullpro.info/2013/poluchaem-vybrannye-stroki-datagridview-v-kotorom-vybrany-tolko-yachejki/">Получаем выбранные строки DataGridView, в котором выбраны только ячейки</a>
						</li>
					<li>
				<a href="http://nullpro.info/2013/oshibka-v-kode-privela-k-ubytkam-v-476-millionov-dollarov-i-bankrotstvu-kompanii/">Ошибка в коде привела к убыткам в 476 миллионов долларов и банкротству компании</a>
						</li>
					<li>
				<a href="http://nullpro.info/2013/otslezhivaem-izmeneniya-vybrannogo-znacheniya-v-kolonke-combobox-datagridview-datagridviewcomboboxcolumn/">Отслеживаем изменения выбранного значения в колонке ComboBox DataGridView (DataGridViewComboBoxColumn)</a>
						</li>
					<li>
				<a href="http://nullpro.info/2013/excel-2010-windows-7-dva-monitora-i-oshibka-pri-napravlenii-komandy-prilozheniyu/">Excel 2010, Windows 7, два монитора и "ошибка при направлении команды приложению"</a>
						</li>
					<li>
				<a href="http://nullpro.info/2013/udalyaem-default-ogranichenie-constraint-v-transact-sql/">Удаляем default-ограничение (constraint) в Transact Sql</a>
						</li>
				</ul>
		</aside><aside id="recent-comments-2" class="widget widget_recent_comments"><h3 class="widget-title">Свежие комментарии</h3><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link"><a href="https://www.linkpress.ru/" rel="external nofollow" class="url">Никита</a></span> к записи <a href="http://nullpro.info/2014/razdelitel-tysyach-i-drobnoj-chasti-dlya-decimal/#comment-115044">Разделитель тысяч и дробной части для decimal</a></li><li class="recentcomments"><span class="comment-author-link"><a href="https://bahisgunceladresi.com/" rel="external nofollow" class="url">JeffreyJax</a></span> к записи <a href="http://nullpro.info/2014/pul-soedinenij-s-bazoj-dannyx-v-ado-net/#comment-113851">Пул соединений с базой данных в ADO.NET / OleDb - как избежать проблем с утечкой соединений в ASP.NET (перевод)</a></li><li class="recentcomments"><span class="comment-author-link"><a href="https://jokermedia.org/" rel="external nofollow" class="url">казино джокер</a></span> к записи <a href="http://nullpro.info/2013/samouchitel-po-c-dlya-nachinayushhix-01-osnovy-yazyka-peremennye-logika-cikly/#comment-111244">Самоучитель по C# для начинающих. 01. Основы языка, переменные, логика, циклы.</a></li><li class="recentcomments"><span class="comment-author-link"><a href="https://profitlinks.xn--ru--8cdaaawt3ababtafcrrelt5bcduleao4a1lzf/" rel="external nofollow" class="url">VladimirFor</a></span> к записи <a href="http://nullpro.info/2014/asp-net-mvc-jqury-i-ajax-otsylaem-dannye-na-server/#comment-110326">ASP .Net MVC, JQuery и AJAX - отсылаем данные на сервер</a></li><li class="recentcomments"><span class="comment-author-link">Cuyccgy</span> к записи <a href="http://nullpro.info/2014/pul-soedinenij-s-bazoj-dannyx-v-ado-net/#comment-109555">Пул соединений с базой данных в ADO.NET / OleDb - как избежать проблем с утечкой соединений в ASP.NET (перевод)</a></li></ul></aside><aside id="archives-2" class="widget widget_archive"><h3 class="widget-title">Архивы</h3>		<ul>
	<li><a href="http://nullpro.info/2015/11/">Ноябрь 2015</a></li>
	<li><a href="http://nullpro.info/2014/10/">Октябрь 2014</a></li>
	<li><a href="http://nullpro.info/2014/08/">Август 2014</a></li>
	<li><a href="http://nullpro.info/2014/04/">Апрель 2014</a></li>
	<li><a href="http://nullpro.info/2014/03/">Март 2014</a></li>
	<li><a href="http://nullpro.info/2014/01/">Январь 2014</a></li>
	<li><a href="http://nullpro.info/2013/11/">Ноябрь 2013</a></li>
	<li><a href="http://nullpro.info/2013/10/">Октябрь 2013</a></li>
	<li><a href="http://nullpro.info/2013/09/">Сентябрь 2013</a></li>
	<li><a href="http://nullpro.info/2013/08/">Август 2013</a></li>
	<li><a href="http://nullpro.info/2013/07/">Июль 2013</a></li>
	<li><a href="http://nullpro.info/2013/05/">Май 2013</a></li>
	<li><a href="http://nullpro.info/2013/04/">Апрель 2013</a></li>
	<li><a href="http://nullpro.info/2013/03/">Март 2013</a></li>
	<li><a href="http://nullpro.info/2013/02/">Февраль 2013</a></li>
	<li><a href="http://nullpro.info/2012/12/">Декабрь 2012</a></li>
	<li><a href="http://nullpro.info/2012/11/">Ноябрь 2012</a></li>
	<li><a href="http://nullpro.info/2012/10/">Октябрь 2012</a></li>
	<li><a href="http://nullpro.info/2012/09/">Сентябрь 2012</a></li>
	<li><a href="http://nullpro.info/2012/08/">Август 2012</a></li>
	<li><a href="http://nullpro.info/2012/07/">Июль 2012</a></li>
	<li><a href="http://nullpro.info/2012/06/">Июнь 2012</a></li>
	<li><a href="http://nullpro.info/2012/04/">Апрель 2012</a></li>
	<li><a href="http://nullpro.info/2012/03/">Март 2012</a></li>
	<li><a href="http://nullpro.info/2012/02/">Февраль 2012</a></li>
	<li><a href="http://nullpro.info/2012/01/">Январь 2012</a></li>
	<li><a href="http://nullpro.info/2011/12/">Декабрь 2011</a></li>
	<li><a href="http://nullpro.info/2011/09/">Сентябрь 2011</a></li>
	<li><a href="http://nullpro.info/2011/07/">Июль 2011</a></li>
	<li><a href="http://nullpro.info/2011/06/">Июнь 2011</a></li>
	<li><a href="http://nullpro.info/2011/05/">Май 2011</a></li>
	<li><a href="http://nullpro.info/2011/04/">Апрель 2011</a></li>
	<li><a href="http://nullpro.info/2011/03/">Март 2011</a></li>
	<li><a href="http://nullpro.info/2011/02/">Февраль 2011</a></li>
	<li><a href="http://nullpro.info/2011/01/">Январь 2011</a></li>
		</ul>
</aside><aside id="meta-2" class="widget widget_meta"><h3 class="widget-title">Мета</h3>			<ul>
						<li><a href="http://nullpro.info/wp-login.php">Войти</a></li>
			<li><a href="http://nullpro.info/feed/"><abbr title="Really Simple Syndication">RSS</abbr> записей</a></li>
			<li><a href="http://nullpro.info/comments/feed/"><abbr title="Really Simple Syndication">RSS</abbr> комментариев</a></li>
<li><a href="https://ru.wordpress.org/" title="Сайт работает на WordPress — современной персональной платформе для публикаций.">WordPress.org</a></li>			</ul>
</aside>	</div><!-- #sidebar_primary .widget-area -->
	</div>
	<!-- #sidebar_wrap_left -->
		<div id="container_wrap" class="container-single equal_height left-1-col">
		<div id="container">
			<div id="content" role="main">

				<nav id="nav-above" class="navigation">
				<h3 class="assistive-text">Навигация по записям</h3>
					<div class="nav-previous"><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-0-klass-i-testovyj-proekt-primer-winforms/" rel="prev"><span class="meta-nav">←</span> Работаем с MS Word из C#, часть 0, класс и тестовый проект-пример WinForms</a></div>
				<div class="nav-next"><a href="http://nullpro.info/2012/ms-word-iz-vstavlyaem-tekst-i-formatiruem/" rel="next">Работаем с MS Word из C#, часть 2. Вставляем текст на закладку и форматируем <span class="meta-nav">→</span></a></div>
				</nav><!-- #nav-above -->


<article id="post-786" class="content-single  post-786 post type-post status-publish format-standard hentry category-ms-office">
	<header class="entry-header">
		<div class="entry-hdr"><h1 class="entry-title">Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа</h1></div>

		<div class="entry-meta">
						<div class="meta-info-wrap">
			<span class="sep">Опубликовано </span><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/" title="12:09" rel="bookmark"><time class="entry-date" datetime="2012-07-11T12:09:09+00:00">11.07.2012</time></a><span class="by-author"> <span class="sep"> автором </span> <span class="author vcard"><a class="url fn n" href="http://nullpro.info/author/stepom/" title="Посмотреть все записи автора Ведомир" rel="author">Ведомир</a></span></span>
			</div><!-- .entry-meta-icons -->		</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

	<div class="entry-content cf">
		<p>Задача: вывести данные в документ Word. На самом деле это очень большая и необъятная тема, примерно как сам Word, 90% возможностей которого не используются обычными пользователями. Сузим до более простой и чаще встречающейся на практике задачи, с которой в своей время пришлось столкнуться мне самому: надо вывести красивую справку, договор, отчет или иной документ Word с добавлением данных из кода C#.  Само собой должны поддерживаться версии Word до 2007, так что о новых форматах файлов  придется забыть.<br>
<span id="more-786"></span><br>
Для начала вспомним, что в Word есть такая замечательная вещь как шаблоны. Соответственно большую часть сложного оформления можно вынести в них и из кода открывать шаблон и вставлять данные в нужные места. Для начала ограничимся простыми строками (типовая задача в крупных предприятиях - вставка дат, цифр, фио и тому подобных вещей, договор на сумму такую-то, от такой-то даты с фио таким-то с параметрами объекта такими-то).</p>
<p>Задача на текущую статью: открыть из кода C# шаблон Word и что-то в него вставить. Шаблон в формате .dot приготовим заранее, в том же самом ворде. Для связи с ним будем использовать механизм <a href="http://msdn.microsoft.com/en-us/library/ms173184.aspx" target="_blank">COM Interoperability</a> (сокращенно Interop), то есть запускать отдельный exe-процесс самого Word и через специальный интерфейс управлять им. Интерфейсы слава богу есть и находятся они в специальных библиотеках, поставляемых вместе с Office, но документация по ним крайне невнятная, поведение местами очень странное и не логичное. В версиях Visual Studio 2010 и выше возможности программирования Office  расширены, но текущее руководство действительно и для 2008 студии. </p>
<p>Нам надо</p>
<p>1. Подключить нужные библиотеки<br>
2. Открыть шаблон Word<br>
3. Найти в нем нужное место<br>
4. Вставить в него строку с информацией</p>
<p>1. Проект в студии у нас уже должен быть. В разделе Ссылки/References кликаем правой кнопкой, идем в "Добавить ссылку" и ищем Microsoft.Office.Interop.Word. В параметрах добавленной библиотеки ставим true в Копировать локально/Copy local, так как библиотеку надо копировать вместе с исполняемыми файлами проекта.</p>
<p>В код добавляем соответствующие using</p>
<div id="highlighter_114551" class="syntaxhighlighter nogutter  "><div class="bar       "><div class="toolbar"><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_114551_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_114551" menu="false" src="http://nullpro.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="content"><code class="keyword">using</code> <code class="plain">Word = Microsoft.Office.Interop.Word;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="keyword">using</code> <code class="plain">System.Reflection;</code></td></tr></tbody></table></div></div></div>
<p>2. Теперь вам предстоит провести много времени с <a href="http://msdn.microsoft.com/ru-ru/library/kw65a0we.aspx" target="_blank">замечательным интерфейсом Word</a>, который представляет сам текстовый редактор и его потроха в виде разнообразных обьектов. Сейчас важны два - Application и Document. Переменные для них по ряду не очевидных причин лучше объявлять через интерфейсы.</p>
<div id="highlighter_944880" class="syntaxhighlighter nogutter  "><div class="bar     "><div class="toolbar"><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_944880_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_944880" menu="false" src="http://nullpro.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="content"><code class="plain">Word._Application application;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="plain">Word._Document document;</code></td></tr></tbody></table></div></div></div>
<p>Так же почти все функции Word требуют объектных параметров, даже если внутри них сидят простые строки и логические значения, так что лучше заранее сделать несколько оберток</p>
<div id="highlighter_680569" class="syntaxhighlighter nogutter  "><div class="bar                      "><div class="toolbar"><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_680569_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_680569" menu="false" src="http://nullpro.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="content"><code class="plain">Object missingObj = System.Reflection.Missing.Value;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="plain">Object trueObj = </code><code class="keyword">true</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="plain">Object falseObj = </code><code class="keyword">false</code><code class="plain">;</code></td></tr></tbody></table></div></div></div>
<p>Чтобы запустить Word и открыть в нем шаблон с диска (путь известен), потребуется примерно такой код </p>
<div id="highlighter_127957" class="syntaxhighlighter nogutter  "><div class="bar                              "><div class="toolbar"><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_127957_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_127957" menu="false" src="http://nullpro.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="content"><code class="comments">//создаем обьект приложения word</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="plain">application = </code><code class="keyword">new</code> <code class="plain">Word.Application();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="comments">// создаем путь к файлу </code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="plain">Object templatePathObj = </code><code class="string">"путь к файлу шаблона"</code><code class="plain">;;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="comments">// если вылетим не этом этапе, приложение останется открытым</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="keyword">try</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">document = application.Documents.Add(</code><code class="keyword">ref</code>&nbsp; <code class="plain">templatePathObj, </code><code class="keyword">ref</code> <code class="plain">missingObj, </code><code class="keyword">ref</code> <code class="plain">missingObj, </code><code class="keyword">ref</code> <code class="plain">missingObj);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="keyword">catch</code> <code class="plain">(Exception error)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">document.Close(</code><code class="keyword">ref</code> <code class="plain">falseObj, </code><code class="keyword">ref</code>&nbsp; <code class="plain">missingObj, </code><code class="keyword">ref</code> <code class="plain">missingObj);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">application.Quit(</code><code class="keyword">ref</code> <code class="plain">missingObj, </code><code class="keyword">ref</code>&nbsp; <code class="plain">missingObj, </code><code class="keyword">ref</code> <code class="plain">missingObj);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">document = </code><code class="keyword">null</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">application = </code><code class="keyword">null</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">throw</code> <code class="plain">error;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="plain">_application.Visible = </code><code class="keyword">true</code><code class="plain">;</code></td></tr></tbody></table></div></div></div>
<p>Принципиально важны два момента</p>
<p>1. Мы создаем неуправляемый ресурс, который не соберет сборщик мусора - отдельный процесс в памяти с приложением Word, если мы его не закроем и не выведем на экран, он так и останется там висеть до выключения компьютера. Более того такие ворды могут накапливаться незаметно для пользователя, программист-то еще прибьет их вручную. Заботиться о высвобождения неуправляемого ресурса должен программист.</p>
<p>2. По умолчанию Word запускается невидимым, на экран его выводим мы.</p>
<p>Для начала рассмотрим самый простой и примитивный вариант - поиск и замена строки в документе Word. Некоторые программисты так и работают - ставят в шаблон текстовую метку вроде @@nowDate и заменяют ее на нужное значение.</p>
<p>Пришло время познакомится с фундаментом работы с Word - великим и ужасным объектом Range. Его суть сложно описать словами -это некоторый произвольный кусок документа, диапазон (range), который может включать в себя все что угодно - от пары символов, до таблиц, закладок и прочих интересных вещей. Не стоит путать его с Selection -  куском документа, выделенным мышкой, который само собой можно конвертировать в Range.  Соотвественно нам надо получить Range для всего документа, найти нужную строку внутри него, получить Range для этой строки и уже внутри этого последнего диапазона заменить текст на требуемый. И не стоит забывать, что документ может иметь сложную структуру с колонтитулами и прочей ересью, возможный универсальный метод для замены всех вхождений данной строки:</p>
<div id="highlighter_799989" class="syntaxhighlighter nogutter  "><div class="bar"><div class="toolbar"><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_799989_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_799989" menu="false" src="http://nullpro.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="content"><code class="comments">// обьектные строки для Word</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="keyword">object</code> <code class="plain">strToFindObj = strToFind;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="keyword">object</code> <code class="plain">replaceStrObj = replaceStr;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="comments">// диапазон документа Word</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="plain">Word.Range wordRange;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="comments">//тип поиска и замены</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="keyword">object</code> <code class="plain">replaceTypeObj;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="plain">replaceTypeObj = Word.WdReplace.wdReplaceAll; </code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="comments">// обходим все разделы документа</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="keyword">for</code> <code class="plain">(</code><code class="keyword">int</code> <code class="plain">i = 1; i &lt;= _document.Sections.Count; i++)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// берем всю секцию диапазоном</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">wordRange = _document.Sections[i].Range;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">/*</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">Обходим редкий глюк в Find, ПРИЗНАННЫЙ MICROSOFT, метод Execute на некоторых машинах вылетает с ошибкой "Заглушке переданы неправильные данные / Stub received bad data"&nbsp; Подробности: <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;313104">http://support.microsoft.com/default.aspx?scid=kb;en-us;313104</a></code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// выполняем метод поиска и&nbsp; замены обьекта диапазона ворд</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">wordRange.Find.Execute(ref strToFindObj, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref replaceStrObj, ref replaceTypeObj, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">*/</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">Word.Find wordFindObj = wordRange.Find;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">object</code><code class="plain">[] wordFindParameters = </code><code class="keyword">new</code> <code class="keyword">object</code><code class="plain">[15] { strToFindObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, replaceStrObj, replaceTypeObj, _missingObj, _missingObj, _missingObj, _missingObj };</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">wordFindObj.GetType().InvokeMember(</code><code class="string">"Execute"</code><code class="plain">, BindingFlags.InvokeMethod, </code><code class="keyword">null</code><code class="plain">, wordFindObj, wordFindParameters);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
<p>Редкий глюк <a href="http://nullpro.info/2011/oshibka-word-interop-stub-recieved-bad-data/">подробно описан здесь.</a></p>
<p>На самом деле это не самый лучший метод для вставки информации в документ, так как могут возникнуть сложности с уникальными именами для текстовых меток (если текст одной входит в начало другой, данный метод найдет ее и заменит), их совпадением с произвольным текстом и так далее.</p>
<p>Даже если нам надо найти (и например отформатировать) именно строку с текстом внутри документа, лучше всего выдать наружу найденный Range и уже с ним производить разные злодеяния. Получим примерно такой метод:</p>
<div id="highlighter_807032" class="syntaxhighlighter nogutter  "><div class="bar"><div class="toolbar"><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_807032_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_807032" menu="false" src="http://nullpro.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="content"><code class="keyword">object</code> <code class="plain">stringToFindObj = stringToFind;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="plain">Word.Range wordRange;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="keyword">bool</code> <code class="plain">rangeFound;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="comments">//в цикле обходим все разделы документа, получаем Range, запускаем поиск</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="comments">// если поиск вернул true, он долже ужать Range до найденное строки, выходим и возвращаем Range</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="comments">// обходим все разделы документа</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="keyword">for</code> <code class="plain">(</code><code class="keyword">int</code> <code class="plain">i = 1; i &lt;= _document.Sections.Count; i++)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// берем всю секцию диапазоном</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">wordRange = _document.Sections[i].Range;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">/*</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// Обходим редкий глюк в Find, ПРИЗНАННЫЙ MICROSOFT, метод Execute на некоторых машинах вылетает с ошибкой "Заглушке переданы неправильные данные / Stub received bad data"&nbsp; Подробности: <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;313104">http://support.microsoft.com/default.aspx?scid=kb;en-us;313104</a></code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// выполняем метод поиска и&nbsp; замены обьекта диапазона ворд</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">rangeFound = wordRange.Find.Execute(ref stringToFindObj, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">*/</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">Word.Find wordFindObj = wordRange.Find;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">object</code><code class="plain">[] wordFindParameters = </code><code class="keyword">new</code> <code class="keyword">object</code><code class="plain">[15] { stringToFindObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj };</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">rangeFound = (</code><code class="keyword">bool</code><code class="plain">)wordFindObj.GetType().InvokeMember(</code><code class="string">"Execute"</code><code class="plain">, BindingFlags.InvokeMethod, </code><code class="keyword">null</code><code class="plain">, wordFindObj, wordFindParameters);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code> <code class="plain">(rangeFound) { </code><code class="keyword">return</code> <code class="plain">wordRange; }</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="comments">// если ничего не нашли, возвращаем null</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="keyword">return</code> <code class="keyword">null</code><code class="plain">;</code></td></tr></tbody></table></div></div></div>
<p>Простейшее решение проблемы уникальности текста (нужно нам найти Range слова Word, но внутри всего документа оно встречается десятки раз) - искать строку внутри строки, сначала найти уникальную строку, потом не уникальную внутри нее, неэстетично, но дешево, надежно и практично.</p>
<div id="highlighter_676154" class="syntaxhighlighter nogutter  "><div class="bar"><div class="toolbar"><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_676154_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_676154" menu="false" src="http://nullpro.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="content"><code class="comments">// оформляем обьектные параметры</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="keyword">object</code> <code class="plain">stringToFindObj = stringToFind;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="keyword">bool</code> <code class="plain">rangeFound;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="comments">/*</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="comments">Обходим редкий глюк в Find, ПРИЗНАННЫЙ MICROSOFT, метод Execute на некоторых машинах вылетает с ошибкой "Заглушке переданы неправильные данные / Stub received bad data" </code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="comments"><a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;313104">http://support.microsoft.com/default.aspx?scid=kb;en-us;313104</a></code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="comments">rangeFound = containerRange.Find.Execute(ref stringToFindObj, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing, ref wordMissing);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="comments">*/</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="plain">Word.Find wordFindObj = containerRange.Find;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="keyword">object</code><code class="plain">[]&nbsp; wordFindParameters = </code><code class="keyword">new</code> <code class="keyword">object</code><code class="plain">[15] { stringToFindObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj, _missingObj };</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="plain">rangeFound = (</code><code class="keyword">bool</code><code class="plain">)wordFindObj.GetType().InvokeMember(</code><code class="string">"Execute"</code><code class="plain">, BindingFlags.InvokeMethod, </code><code class="keyword">null</code><code class="plain">, wordFindObj, wordFindParameters);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="keyword">if</code> <code class="plain">(rangeFound) { </code><code class="keyword">return</code> <code class="plain">containerRange; }</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="keyword">else</code> <code class="plain">{ </code><code class="keyword">return</code> <code class="keyword">null</code><code class="plain">; }</code></td></tr></tbody></table></div></div></div>
<p>Если строку надо просто заменить, то сойдет простейшее </p>
<div id="highlighter_537328" class="syntaxhighlighter nogutter  "><div class="bar"><div class="toolbar"><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_537328_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_537328" menu="false" src="http://nullpro.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="content"><code class="plain">_range.Text = </code><code class="string">"Это текст заменит содержимое Range"</code><code class="plain">;</code></td></tr></tbody></table></div></div></div>
<p>Но так как Range  является универсальный контейнером для любого куска документа Word, то его возможности неизмеримо шире, часть их будет рассмотрена в дальнейших заметках.</p>
<p>Если нам надо просто встать в начало документа (и что-то вставить уже туда):</p>
<div id="highlighter_406126" class="syntaxhighlighter nogutter  "><div class="bar"><div class="toolbar"><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_406126_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_406126" menu="false" src="http://nullpro.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="content"><code class="keyword">object</code> <code class="plain">start = 0;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="keyword">object</code> <code class="plain">end = 0;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="content"><code class="plain">_currentRange = _document.Range(</code><code class="keyword">ref</code> <code class="plain">start, </code><code class="keyword">ref</code> <code class="plain">end);</code></td></tr></tbody></table></div></div></div>
<p>Сохранить документ на диск можно следующим образом</p>
<div id="highlighter_897579" class="syntaxhighlighter nogutter  "><div class="bar"><div class="toolbar"><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_897579_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_897579" menu="false" src="http://nullpro.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="content"><code class="plain">Object pathToSaveObj = pathToSaveString;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="content"><code class="plain">_document.SaveAs(</code><code class="keyword">ref</code> <code class="plain">pathToSaveObj, Word.WdSaveFormat.wdFormatDocument, </code><code class="keyword">ref</code> <code class="plain">_missingObj, </code><code class="keyword">ref</code> <code class="plain">_missingObj, </code><code class="keyword">ref</code> <code class="plain">_missingObj, </code><code class="keyword">ref</code> <code class="plain">_missingObj, </code><code class="keyword">ref</code> <code class="plain">_missingObj, </code><code class="keyword">ref</code> <code class="plain">_missingObj, </code><code class="keyword">ref</code> <code class="plain">_missingObj, </code><code class="keyword">ref</code> <code class="plain">_missingObj, </code><code class="keyword">ref</code> <code class="plain">_missingObj, </code><code class="keyword">ref</code> <code class="plain">_missingObj, </code><code class="keyword">ref</code> <code class="plain">_missingObj, </code><code class="keyword">ref</code> <code class="plain">_missingObj, </code><code class="keyword">ref</code> <code class="plain">_missingObj, </code><code class="keyword">ref</code> <code class="plain">_missingObj);</code></td></tr></tbody></table></div></div></div>
<ol>
<li><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-0-klass-i-testovyj-proekt-primer-winforms/">Работаем с MS Word из C#, часть 0, класс и тестовый проект-пример WinForms</a></li>
<li><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/">Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа</a></li>
<li><a href="http://nullpro.info/2012/ms-word-iz-vstavlyaem-tekst-i-formatiruem/">Работаем с MS Word из C#, часть 2. Вставляем текст на закладку и форматируем</a></li>
<li><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-3-rabota-s-tablicami/">Работаем с MS Word из C#, часть 3. Работа с таблицами</a></li>
<li><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-4-obedinyaem-neskolko-fajlov-v-odin/">Работаем с MS Word из C#, часть 4. Обьединяем несколько файлов в один, считаем количество страниц</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/ms254954%28v=office.11%29" target="_blank">Microsoft.Office.Interop.Word Namespace  </a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.range_members%28v=office.11%29">Range Interface</a></li>
</ol>
			</div><!-- .entry-content -->

	<footer class="entry-utility">
<div class="meta-info-wrap">
			<span class="cat-links">
<span class="entry-utility-prep entry-utility-prep-cat-links">Рубрика:</span> <a href="http://nullpro.info/category/c/ms-office/" rel="category tag">MS Office</a>			</span>
		<span class="permalink-icon"><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/" title="Permalink to Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа" rel="bookmark">Постоянная ссылка</a></span>
	</div><!-- .entry-meta-icons -->

	</footer><!-- .entry-utility -->
</article><!-- #post-786 -->

				<nav id="nav-below" class="navigation">
				<h3 class="assistive-text">Навигация по записям</h3>
					<div class="nav-previous"><a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-0-klass-i-testovyj-proekt-primer-winforms/" rel="prev"><span class="meta-nav">←</span> Работаем с MS Word из C#, часть 0, класс и тестовый проект-пример WinForms</a></div>
				<div class="nav-next"><a href="http://nullpro.info/2012/ms-word-iz-vstavlyaem-tekst-i-formatiruem/" rel="next">Работаем с MS Word из C#, часть 2. Вставляем текст на закладку и форматируем <span class="meta-nav">→</span></a></div>
				</nav><!-- #nav-above -->


	<div id="comments">

		<hr class="comments-hr">
		<header id="comments-title">
		<h3>Комментарии</h3>
				<h4>
<em>Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа</em> — Комментарии (8)		</h4>
		</header>

		
		<ol class="commentlist">
				<li class="comment even thread-even depth-1" id="li-comment-37689">
		<article id="comment-37689" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
<span class="fn">Павел</span> <span class="says">говорит</span> <a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#comment-37689"><time datetime="2016-02-24T18:41:16+00:00">24.02.2016 в 18:41</time></a>:
				</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>Локально этот код работает, но как быть с сервером? Как сделать так, чтобы Word открывался на стороне клиента, когда сайт и файлы уже на сервере?</p>
</div>
			<div class="reply">
				<a class="comment-reply-link" href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/?replytocom=37689#respond" onclick="return addComment.moveForm( &quot;comment-37689&quot;, &quot;37689&quot;, &quot;respond&quot;, &quot;786&quot; )" aria-label="Комментарий к записи Павел">Ответить <span>↓</span></a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-48020">
		<article id="comment-48020" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
<span class="fn">tonDavid</span> <span class="says">говорит</span> <a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#comment-48020"><time datetime="2017-02-27T13:12:34+00:00">27.02.2017 в 13:12</time></a>:
				</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>333</p>
</div>
			<div class="reply">
				<a class="comment-reply-link" href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/?replytocom=48020#respond" onclick="return addComment.moveForm( &quot;comment-48020&quot;, &quot;48020&quot;, &quot;respond&quot;, &quot;786&quot; )" aria-label="Комментарий к записи tonDavid">Ответить <span>↓</span></a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-53834">
		<article id="comment-53834" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
<span class="fn"><a href="http://ch-investor.tk/" rel="external nofollow" class="url">negoret</a></span> <span class="says">говорит</span> <a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#comment-53834"><time datetime="2017-06-07T21:25:55+00:00">07.06.2017 в 21:25</time></a>:
				</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>Предлагаю кредит от частного инвестора. Процент одобрения 97%.</p>
</div>
			<div class="reply">
				<a class="comment-reply-link" href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/?replytocom=53834#respond" onclick="return addComment.moveForm( &quot;comment-53834&quot;, &quot;53834&quot;, &quot;respond&quot;, &quot;786&quot; )" aria-label="Комментарий к записи negoret">Ответить <span>↓</span></a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-72745">
		<article id="comment-72745" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
<span class="fn">Оох</span> <span class="says">говорит</span> <a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#comment-72745"><time datetime="2018-05-08T23:30:54+00:00">08.05.2018 в 23:30</time></a>:
				</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p><strong><em>Ебу ваших матерей</em></strong></p>
</div>
			<div class="reply">
				<a class="comment-reply-link" href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/?replytocom=72745#respond" onclick="return addComment.moveForm( &quot;comment-72745&quot;, &quot;72745&quot;, &quot;respond&quot;, &quot;786&quot; )" aria-label="Комментарий к записи Оох">Ответить <span>↓</span></a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-74860">
		<article id="comment-74860" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
<span class="fn">Азат</span> <span class="says">говорит</span> <a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#comment-74860"><time datetime="2018-06-13T13:47:24+00:00">13.06.2018 в 13:47</time></a>:
				</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>А можно код целиком скинуть?</p>
</div>
			<div class="reply">
				<a class="comment-reply-link" href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/?replytocom=74860#respond" onclick="return addComment.moveForm( &quot;comment-74860&quot;, &quot;74860&quot;, &quot;respond&quot;, &quot;786&quot; )" aria-label="Комментарий к записи Азат">Ответить <span>↓</span></a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-87892">
		<article id="comment-87892" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
<span class="fn">fer</span> <span class="says">говорит</span> <a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#comment-87892"><time datetime="2019-02-08T09:52:00+00:00">08.02.2019 в 9:52</time></a>:
				</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>подскажите при запуске на моменте<br>
wordapp = new Word.Application(); идет долгая загрузка 30с\. как можно ускорить?</p>
</div>
			<div class="reply">
				<a class="comment-reply-link" href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/?replytocom=87892#respond" onclick="return addComment.moveForm( &quot;comment-87892&quot;, &quot;87892&quot;, &quot;respond&quot;, &quot;786&quot; )" aria-label="Комментарий к записи fer">Ответить <span>↓</span></a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-100231">
		<article id="comment-100231" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
<span class="fn">Артур</span> <span class="says">говорит</span> <a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#comment-100231"><time datetime="2019-09-12T14:19:05+00:00">12.09.2019 в 14:19</time></a>:
				</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>Здравствуйте, подскажите.<br>
Среда ругается на containerRange пишет что не он существует, надо такой объект создать?</p>
</div>
			<div class="reply">
				<a class="comment-reply-link" href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/?replytocom=100231#respond" onclick="return addComment.moveForm( &quot;comment-100231&quot;, &quot;100231&quot;, &quot;respond&quot;, &quot;786&quot; )" aria-label="Комментарий к записи Артур">Ответить <span>↓</span></a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-103480">
		<article id="comment-103480" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
<span class="fn">Бог Шиноби</span> <span class="says">говорит</span> <a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#comment-103480"><time datetime="2019-11-19T12:13:15+00:00">19.11.2019 в 12:13</time></a>:
				</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>Почему на плойку нет первой rdr, почему так сука, как мне, блять жить, мне че сука придется xbox брать, я че не в Росии живу , ублюдки ебаные?<br>
Ясно,админ высрал хуйню .<br>
Саша 18 годикоф ищу меч артура</p>
</div>
			<div class="reply">
				<a class="comment-reply-link" href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/?replytocom=103480#respond" onclick="return addComment.moveForm( &quot;comment-103480&quot;, &quot;103480&quot;, &quot;respond&quot;, &quot;786&quot; )" aria-label="Комментарий к записи Бог Шиноби">Ответить <span>↓</span></a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
		</ol>

		
							<div id="respond" class="comment-respond">
				<h3 id="reply-title" class="comment-reply-title">Добавить комментарий <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#respond" style="display:none;">Отменить ответ</a></small></h3>
									<form action="http://nullpro.info/wp-comments-post.php" method="post" id="commentform" class="comment-form">
																			<p class="comment-notes"><span id="email-notes">Ваш e-mail не будет опубликован.</span> Обязательные поля помечены <span class="required">*</span></p>							<p class="comment-form-author"><label for="author">Имя <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" aria-required="true" required="required"></p>
<p class="comment-form-email"><label for="email">E-mail <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" aria-describedby="email-notes" aria-required="true" required="required"></p>
<p class="comment-form-url"><label for="url">Сайт</label> <input id="url" name="url" type="text" value="" size="30"></p>

<div class="captchaSizeDivLarge"><img id="si_image_com" class="si-captcha" src="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/securimage_show.php" width="175" height="60" alt="CAPTCHA изображение" title="CAPTCHA изображение">
    <input id="si_code_com" name="si_code_com" type="hidden" value="TlDkE8nlxgtCo36E">
    <div id="si_refresh_com">
<a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#" rel="nofollow" title="Обновить изображение" onclick="si_captcha_refresh(&#39;si_image_com&#39;,&#39;com&#39;,&#39;/wp-content/plugins/si-captcha-for-wordpress/captcha&#39;,&#39;http://nullpro.info/wp-content/plugins/si-captcha-for-wordpress/captcha/securimage_show.php?si_form_id=com&amp;prefix=&#39;); return false;">
      <img class="captchaImgRefresh" src="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/refresh.png" width="22" height="20" alt="Обновить изображение" onclick="this.blur();"></a>
  </div>
  </div>
<br>
<p><input id="captcha_code" name="captcha_code" type="text" size="6">
<label id="captcha_code_label" for="captcha_code">CAPTCHA Code</label><span class="required">*</span>
</p>												<p class="comment-form-comment"><label for="comment">Комментарий</label> <script type="text/javascript">var edInserted; if (!edInserted) {edToolbar(); edInserted = true;}</script></p><div id="ed_toolbar"><input type="button" id="ed_strong" accesskey="b" class="ed_button" onclick="edInsertTag(edCanvas, 0);" value="b"><input type="button" id="ed_em" accesskey="i" class="ed_button" onclick="edInsertTag(edCanvas, 1);" value="i"><input type="button" id="ed_del" accesskey="d" class="ed_button" onclick="edInsertTag(edCanvas, 2);" value="del"><input type="button" id="ed_link" accesskey="a" class="ed_button" onclick="edInsertLink(edCanvas, 3);" value="link"><input type="button" id="ed_block" accesskey="q" class="ed_button" onclick="edInsertTag(edCanvas, 4);" value="b-quote"><input type="button" id="ed_code" accesskey="c" class="ed_button" onclick="edInsertTag(edCanvas, 5);" value="code"><input type="button" id="ed_close" class="ed_button" onclick="edCloseAllTags();" value="Close Tags"></div>
<textarea id="comment" name="comment" cols="45" rows="8" aria-describedby="form-allowed-tags" aria-required="true" required="required"></textarea>
<script type="text/javascript">var edCanvas = document.getElementById('comment');</script><p></p>						<p class="form-allowed-tags" id="form-allowed-tags">Можно использовать следующие <abbr title="HyperText Markup Language">HTML</abbr>-теги и атрибуты:  <code>&lt;a href="" title=""&gt; &lt;abbr title=""&gt; &lt;acronym title=""&gt; &lt;b&gt; &lt;blockquote cite=""&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=""&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=""&gt; &lt;s&gt; &lt;strike&gt; &lt;strong&gt; </code></p>
						<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Отправить комментарий"> <input type="hidden" name="comment_post_ID" value="786" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">

<input name="acp-preview" type="button" id="acp-preview" tabindex="6" value="Просмотреть"></p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="31e3116651"></p><div id="ajax-comment-preview">Click the "Preview" button to preview your comment here.</div><p style="display: none;"></p>					<input type="hidden" id="ak_js" name="ak_js" value="1601461560987"></form>
							</div><!-- #respond -->
			</div><!-- #comments -->


			</div><!-- #content -->
		</div><!-- #container -->
		</div><!-- #container_wrap -->

    <div class="weaver-clear"></div></div><!-- #main -->
	<footer id="colophon" role="contentinfo">
	  <div>

		<div id="site-ig-wrap">
		<span id="site-info">
		© 2020 - <a href="http://nullpro.info/" title="Записная книжка программиста-новичка, C#, SQL, PHP и все-все-все" rel="home">Записная книжка программиста-новичка, C#, SQL, PHP и все-все-все</a>
		</span> <!-- #site-info -->
		<span id="site-generator">
		<a href="http://wordpress.org/" title="wordpress.org" rel="generator" target="_blank">Сайт работает на WordPress</a>&nbsp;
Weaver II by <a href="http://weavertheme.com/" target="_blank" title="http://weavertheme.com">WP Weaver</a>
		</span> <!-- #site-generator -->
		</div><!-- #site-ig-wrap -->
		<div class="weaver-clear"></div>
	  </div>
	</footer><!-- #colophon -->
</div><!-- #wrapper -->
<a href="http://nullpro.info/2012/rabotaem-s-ms-word-iz-c-chast-1-otkryvaem-shablon-ishhem-tekst-vnutri-dokumenta/#page-top" id="page-bottom">↑</a>
<div id="weaver-final" class="weaver-final-normal"><script type="text/javascript" src="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/si_captcha.js.Без названия"></script>
<script type="text/javascript">
//<![CDATA[
var si_captcha_styles = "\
<!-- begin SI CAPTCHA Anti-Spam - comment form style -->\
<style type='text/css'>\
div#captchaImgDiv { display:block; }\
.captchaSizeDivSmall { width:175px; height:45px; padding-top:10px; }\
.captchaSizeDivLarge { width:250px; height:60px; padding-top:10px; }\
img#si_image_com,#si_image_reg,#si_image_log,#si_image_side_login { border-style:none; margin:0; padding-right:5px; float:left; }\
.captchaImgRefresh { border-style:none; margin:0; vertical-align:bottom; }\
div#captchaInputDiv { display:block; padding-top:15px; padding-bottom:5px; }\
label#captcha_code_label { margin:0; }\
input#captcha_code { width:65px; }\
</style>\
<!-- end SI CAPTCHA Anti-Spam - comment form style -->\
";
jQuery(document).ready(function($) {
$('head').append(si_captcha_styles);
});
//]]>
</script>
<script type="text/javascript" src="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/form.js.Без названия"></script>
<script type="text/javascript" src="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/shCore.js.Без названия"></script>
<script type="text/javascript" src="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/shBrushCSharp.js.Без названия"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://nullpro.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/styles/shCore.css?ver=2.1.364";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://nullpro.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/styles/shThemeEclipse.css?ver=2.1.364";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.clipboardSwf = 'http://nullpro.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf';
	SyntaxHighlighter.config.strings.expandSource = 'show source';
	SyntaxHighlighter.config.strings.viewSource = 'view source';
	SyntaxHighlighter.config.strings.copyToClipboard = 'copy to clipboard';
	SyntaxHighlighter.config.strings.copyToClipboardConfirmation = 'The code is in your clipboard now';
	SyntaxHighlighter.config.strings.print = 'print';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.all();
</script>
<script type="text/javascript" src="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/comment-reply.min.js.Без названия"></script>
<script type="text/javascript">
/* <![CDATA[ */
var weaver_menu_params = {"selector":"li:has(ul) > a","selector_leaf":"li li li:not(:has(ul)) > a"};
/* ]]> */
</script>
<script type="text/javascript" src="./Работаем с MS Word из C#, часть 1. Открываем шаблон, ищем текст внутри документа_files/weaverjslib.min.js.Без названия"></script>
</div> <!-- #weaver-final -->


</body></html>